[{"id":"ae63644c6a89b1dcf12bd6f46e9970d0","title":"10个有趣的Python高级脚本","content":"10个有趣的Python高级脚本▍1、Jpg转Png\n图片格式转换，以前可能第一时间改文件名(｀・ω・´)。\n如今编写一个Python脚本就能完成各种图片格式的转换，此处以jpg转成png为例。\n有两种解决方法，都分享给大家。\n\n# 图片格式转换, Jpg转Png\n\n# 方法①\nfrom PIL import Image\n\nimg &#x3D; Image.open(&#39;test.xlsx.jpg&#39;)\nimg.save(&#39;test1.png&#39;)\n\n# 方法②\nfrom cv2 import imread, imwrite\n\nimage &#x3D; imread(&quot;test.xlsx.jpg&quot;, 1)\nimwrite(&quot;test2.png&quot;, image)\n\n▍2、PDF加密和解密\n如果你有100个或更多的PDF文件需要加密，手动进行加密肯定是不可行的，极其浪费时间。\n使用Python的pikepdf模块，即可对文件进行加密，写一个循环就能进行批量加密文档。\n\n# PDF加密\nimport pikepdf\n\npdf &#x3D; pikepdf.open(&quot;test.xlsx.pdf&quot;)\npdf.save(&#39;encrypt.pdf&#39;, encryption&#x3D;pikepdf.Encryption(owner&#x3D;&quot;your_password&quot;, user&#x3D;&quot;your_password&quot;, R&#x3D;4))\npdf.close()\n\n\n有加密那么便会有解密，代码如下：\n\n# PDF解密\nimport pikepdf\n\npdf &#x3D; pikepdf.open(&quot;encrypt.pdf&quot;, password&#x3D;&#39;your_password&#39;)\npdf.save(&quot;decrypt.pdf&quot;)\npdf.close()\n\n▍3、获取电脑的配置信息\n很多小伙伴可能会使用鲁大师来看自己的电脑配置，这样还需要下载一个软件。\n使用Python的WMI模块，便可以轻松查看你的电脑信息。\n\n# 获取计算机信息\nimport wmi\n\n\ndef System_spec():\n    Pc &#x3D; wmi.WMI()\n    os_info &#x3D; Pc.Win32_OperatingSystem()[0]\n    processor &#x3D; Pc.Win32_Processor()[0]\n    Gpu &#x3D; Pc.Win32_VideoController()[0]\n    os_name &#x3D; os_info.Name.encode(&#39;utf-8&#39;).split(b&#39;|&#39;)[0].decode(&#39;utf-8&#39;)\n    ram &#x3D; float(os_info.TotalVisibleMemorySize) &#x2F; 1048576\n    print(f&#39;操作系统: &#123;os_name&#125;&#39;)\n    print(f&#39;CPU: &#123;processor.Name&#125;&#39;)\n    print(f&#39;内存: &#123;ram&#125; GB&#39;)\n    print(f&#39;显卡: &#123;Gpu.Name&#125;&#39;)\n    print(&quot;\\n计算机信息如上 ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑&quot;)\n\n\nif __name__ &#x3D;&#x3D; &#39;__main__&#39;:\n    System_spec()\n\n\n就以我自己的电脑为例，运行代码就能看到配置\n\n操作系统: Microsoft Windows 10 专业版\nCPU: Intel(R) Core(TM) i3-10100 CPU @ 3.60GHz\n内存: 15.833415985107422 GB\n显卡: Intel(R) UHD Graphics 630\n\n计算机信息如上 ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑ ↑\n\n▍4、解压文件\n使用zipfile模块进行文件解压，同理也可以对文件进行压缩。\n\n# 解压文件\nfrom zipfile import ZipFile\n\nunzip &#x3D; ZipFile(&quot;file.zip&quot;, &quot;r&quot;)\nunzip.extractall(&quot;output Folder&quot;)\n\n▍5、Excel工作表合并\n帮助你将Excel工作表合并到一张表上，表内容如下图：\n\n6张表，其余表的内容和第一张表都一样。\n\n设置表格数量为5，将会合并前5张表的内容。\n\n\nimport pandas as pd\n\n# 文件名\nfilename &#x3D; &quot;test.xlsx&quot;\n# 表格数量\nT_sheets &#x3D; 5\n\ndf &#x3D; []\nfor i in range(1, T_sheets + 1):\n    sheet_data &#x3D; pd.read_excel(filename, sheet_name&#x3D;i, header&#x3D;None)\n    df.append(sheet_data)\n\n# 合并表格\noutput &#x3D; &quot;merged.xlsx&quot;\ndf &#x3D; pd.concat(df)\ndf.to_excel(output)\n\n\n结果如下：\n\n▍6、将图像转换为素描图\n和之前的图片格式转换有点类似，就是对图像进行处理。\n以前大家可能会使用到美图秀秀，现在可能就是抖音的滤镜了。\n其实使用Python的OpenCV，就能够快速实现很多你想要的效果。\n\n# 图像转换\nimport cv2\n\n# 读取图片\nimg &#x3D; cv2.imread(&quot;img.jpg&quot;)\n# 灰度\ngrey &#x3D; cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)\ninvert &#x3D; cv2.bitwise_not(grey)\n# 高斯滤波\nblur_img &#x3D; cv2.GaussianBlur(invert, (7, 7), 0)\ninverse_blur &#x3D; cv2.bitwise_not(blur_img)\nsketch_img &#x3D; cv2.divide(grey, inverse_blur, scale&#x3D;256.0)\n# 保存\ncv2.imwrite(&#39;sketch.jpg&#39;, sketch_img)\ncv2.waitKey(0)\ncv2.destroyAllWindows()\n\n\n原图如下：\n\n素描图如下，还挺好看的\n\n\n▍7、获取CPU温度\n有了这个Python脚本，你将不需要任何软件来了解CPU的温度。\n\n# 获取CPU温度\nfrom time import sleep\nfrom pyspectator.processor import Cpu\n\ncpu &#x3D; Cpu(monitoring_latency&#x3D;1)\nwith cpu:\n    while True:\n        print(f&#39;Temp: &#123;cpu.temperature&#125; °C&#39;)\n        sleep(2)\n\n▍8、提取PDF表格\n有的时候，我们需要从PDF中提取表格数据。\n下面这个简单的脚本将帮助你在一秒钟内完成相同的操作。\n\n# 方法①\nimport camelot\n\ntables &#x3D; camelot.read_pdf(&quot;tables.pdf&quot;)\nprint(tables)\ntables.export(&quot;extracted.csv&quot;, f&#x3D;&quot;csv&quot;, compress&#x3D;True)\n\n# 方法②, 需要安装Java8\nimport tabula\n\ntabula.read_pdf(&quot;tables.pdf&quot;, pages&#x3D;&quot;all&quot;)\ntabula.convert_into(&quot;table.pdf&quot;, &quot;output.csv&quot;, output_format&#x3D;&quot;csv&quot;, pages&#x3D;&quot;all&quot;)\n\n\nPDF文档的内容如下，包含了一个表格。\n\n提取到的CSV文件内容如下：\n\n\n▍9、截图\n该脚本将简单地截取屏幕截图，而无需使用任何屏幕截图软件。\n\n# 方法①\nfrom mss import mss\n\nwith mss() as screenshot:\n    screenshot.shot(output&#x3D;&#39;scr.png&#39;)\n\n# 方法②\nimport PIL.ImageGrab\n\nscr &#x3D; PIL.ImageGrab.grab()\nscr.save(&quot;scr.png&quot;)\n\n▍10、拼写检查器\n这个Python脚本可以进行拼写检查，当然只对英文有效，毕竟中文博大精深呐。\n\n# 拼写检查\n# 方法①\nimport textblob\n\ntext &#x3D; &quot;mussage&quot;\nprint(&quot;original text: &quot; + str(text))\n\nchecked &#x3D; textblob.TextBlob(text)\nprint(&quot;corrected text: &quot; + str(checked.correct()))\n\n# 方法②\nimport autocorrect\n\nspell &#x3D; autocorrect.Speller(lang&#x3D;&#39;en&#39;)\n\n# 以英语为例\nprint(spell(&#39;cmputr&#39;))\nprint(spell(&#39;watr&#39;))\nprint(spell(&#39;survice&#39;))","slug":"post4","date":"2022-11-25T07:34:08.000Z","categories_index":"Script","tags_index":"Python","author_index":"DwyaneLee"},{"id":"d9d5b92cc89a9a959cc07650f502c9c9","title":"post3","content":"test3测试3import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","slug":"post3","date":"2022-11-23T03:36:41.000Z","categories_index":"","tags_index":"test","author_index":"DwyaneLee"},{"id":"c5749e5a4a999cd79b953d6e1af6619a","title":"post2","content":"test2测试2import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","slug":"post2","date":"2022-11-23T03:36:37.000Z","categories_index":"","tags_index":"test","author_index":"DwyaneLee"},{"id":"ca91d7e46a7142c8ad42dd23db7bac4e","title":"post1","content":"test1测试1import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","slug":"post1","date":"2022-11-23T03:10:04.000Z","categories_index":"","tags_index":"test","author_index":"DwyaneLee"},{"id":"b9663f58f18133b35bfe243f3e916a80","title":"Hello World","content":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub.\nQuick StartCreate a new post$ hexo new &quot;My New Post&quot;\n\nMore info: Writing\nRun server$ hexo server\n\nMore info: Server\nGenerate static files$ hexo generate\n\nMore info: Generating\nDeploy to remote sites$ hexo deploy\n\nMore info: Deployment\n","slug":"hello-world","date":"2022-11-22T10:44:21.572Z","categories_index":"","tags_index":"","author_index":"DwyaneLee"}]